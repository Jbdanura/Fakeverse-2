"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[491],{8491:(e,t,s)=>{s.d(t,{L:()=>w});var a=s(5155),r=s(2115),l=s(5565),n=s(3898),o=s(4085),c=s(5007),i=s(2336),d=s(434),m=s(9602);let u=r.forwardRef((e,t)=>{let{className:s,orientation:r="horizontal",decorative:l=!0,...n}=e;return(0,a.jsx)(d.b,{ref:t,decorative:l,orientation:r,className:(0,m.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",s),...n})});u.displayName=d.b.displayName;var x=s(750),f=s(4858),h=s(591),p=s(9271),g=s(8283),j=s(8173),N=s.n(j),v=s(7837);function y(e){let{open:t,onOpenChange:s,title:r="Likes",likes:l}=e;return(0,a.jsx)(v.lG,{open:t,onOpenChange:s,children:(0,a.jsxs)(v.Cf,{className:"sm:max-w-[425px]",children:[(0,a.jsx)(v.c7,{children:(0,a.jsx)(v.L3,{className:"text-center text-xl",children:r})}),(0,a.jsx)("div",{className:"max-h-[60vh] overflow-y-auto",children:(0,a.jsx)("div",{className:"space-y-2",children:l.length>0?l.map(e=>(0,a.jsx)(N(),{href:"/profile/".concat(e.user.username),className:"block p-2 hover:bg-gray-100 rounded",children:e.user.username},e.id)):(0,a.jsx)("div",{className:"text-center py-4 text-muted-foreground",children:"No users found."})})})]})})}function w(e){let{post:t,baseUrl:s,onDelete:d}=e,m=localStorage.getItem("username"),j=!!t.Likes&&!!m&&t.Likes.some(e=>e.user.username===m),[v,w]=(0,r.useState)(j),[k,b]=(0,r.useState)(!1),[C,S]=(0,r.useState)(!1),[L,z]=(0,r.useState)(""),[E,A]=(0,r.useState)(t.Likes.length),[R,I]=(0,r.useState)(!1),[T,B]=(0,r.useState)(!1),[D,U]=(0,r.useState)(null),[F,O]=(0,r.useState)(null),[_,q]=(0,r.useState)(t.Comments),[J,K]=(0,r.useState)(t.Likes),P="dchytnqhl",Z=async()=>{let e=localStorage.getItem("token");if(e){try{let a=await fetch("".concat(s,"/posts/like/").concat(t.id),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(a.ok){let e=await a.json();v?(A(E-1),K(e=>e.filter(e=>e.user.username!==m))):(A(E+1),K([...J,e]))}else console.error("Failed to like post")}catch(e){console.error("Error liking post:",e)}w(!v)}},$=()=>{S(!C)},W=async()=>{if(!L.trim())return;let e=localStorage.getItem("token");if(e)try{let a=await fetch("".concat(s,"/posts/comment/").concat(t.id),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({description:L.trim()})});if(a.ok){let e=await a.json();e.user={username:localStorage.getItem("username")||"Unknown"},q(t=>[...t,e]),z("")}else console.error("Failed to post comment")}catch(e){console.error("Error posting comment:",e)}},G=async()=>{let e=localStorage.getItem("token");if(e)try{(await fetch("".concat(s,"/posts/").concat(t.id),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}})).ok?(O("Post deleted"),setTimeout(()=>{d(t.id)},2e3)):(O("Failed to delete post"),setTimeout(()=>{O(null)},2e3))}catch(e){console.error("Error deleting post:",e),O("Failed to delete post"),setTimeout(()=>{O(null)},2e3)}},H=async e=>{let t=localStorage.getItem("token");if(t)try{(await fetch("".concat(s,"/posts/comment/").concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t)}})).ok?q(t=>t.filter(t=>t.id!==e)):console.error("Failed to delete comment")}catch(e){console.error("Error deleting comment:",e)}};return(0,a.jsxs)(c.Zp,{className:"relative",children:[F&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 text-white text-lg font-bold z-10",children:F}),(0,a.jsx)(c.aR,{className:"pb-3",children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)(N(),{href:"/profile/".concat(t.username),className:"flex items-center gap-3",children:[(0,a.jsxs)(n.eu,{children:[(0,a.jsx)(n.BK,{src:"https://res.cloudinary.com/".concat(P,"/image/upload/fakeverse/").concat(t.username,".png"),alt:t.username}),(0,a.jsx)(n.q5,{children:t.username.charAt(0).toUpperCase()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-semibold",children:t.username}),(0,a.jsxs)("div",{className:"text-xs text-muted-foreground",children:["@",t.username," \xb7 ",t.updatedAt.slice(0,10)]})]})]}),localStorage.getItem("username")===t.username&&(0,a.jsxs)(x.rI,{children:[(0,a.jsx)(x.ty,{asChild:!0,children:(0,a.jsxs)(o.$,{variant:"ghost",size:"icon",className:"h-8 w-8",children:[(0,a.jsx)(f.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"More options"})]})}),(0,a.jsx)(x.SQ,{align:"end",children:(0,a.jsx)(x._2,{className:"text-destructive",onClick:G,children:"Delete post"})})]})]})}),(0,a.jsxs)(c.Wu,{className:"pb-3",children:[(0,a.jsx)("p",{className:"mb-3",children:t.content}),t.image&&(0,a.jsx)("div",{className:"relative rounded-md overflow-hidden mb-3",children:(0,a.jsx)(l.default,{src:t.image||"/placeholder.svg",alt:"Post image",width:600,height:400,className:"w-full object-cover"})})]}),(0,a.jsxs)(c.wL,{className:"flex flex-col pt-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,a.jsxs)("button",{className:"flex items-center gap-1 text-muted-foreground text-sm hover:underline",onClick:()=>{I(!0)},children:[(0,a.jsx)(h.A,{className:"h-4 w-4 ".concat(v?"fill-primary text-primary":"")}),(0,a.jsxs)("span",{children:[E," likes"]})]}),(0,a.jsx)("div",{className:"flex items-center gap-1 text-muted-foreground text-sm",children:(0,a.jsxs)("span",{onClick:$,children:[_.length," comments"]})})]}),(0,a.jsx)(u,{className:"my-3"}),(0,a.jsxs)("div",{className:"flex items-center justify-around w-full",children:[(0,a.jsxs)(o.$,{variant:"ghost",size:"sm",className:"flex items-center gap-1 text-muted-foreground",onClick:Z,children:[(0,a.jsx)(h.A,{className:"h-4 w-4 ".concat(v?"fill-primary text-primary":"")}),"Like"]}),(0,a.jsxs)(o.$,{variant:"ghost",size:"sm",className:"flex items-center gap-1 text-muted-foreground",onClick:$,children:[(0,a.jsx)(p.A,{className:"h-4 w-4"}),"Comment"]})]}),C&&(0,a.jsxs)("div",{className:"w-full mt-3 space-y-3",children:[(0,a.jsx)(u,{}),_.map(e=>{var t,s,r;let l=(null===(t=e.user)||void 0===t?void 0:t.username)||localStorage.getItem("username")||"Unknown",o=(null===(s=e.user)||void 0===s?void 0:s.username)?e.user.username.charAt(0).toUpperCase():"U";return(0,a.jsxs)("div",{className:"flex items-start gap-2 pt-3 relative",children:[(0,a.jsx)(N(),{href:"/profile/".concat(e.user.username),children:(0,a.jsxs)(n.eu,{className:"h-8 w-8",children:[(0,a.jsx)(n.BK,{src:"https://res.cloudinary.com/".concat(P,"/image/upload/fakeverse/").concat(e.user.username,".png"),alt:l}),(0,a.jsx)(n.q5,{children:o})]})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"bg-muted p-2 rounded-md relative",children:[localStorage.getItem("username")===(null===(r=e.user)||void 0===r?void 0:r.username)&&(0,a.jsx)("button",{onClick:()=>H(e.id),className:"absolute top-1 right-1 text-xs text-red-500 hover:underline",children:"Delete"}),(0,a.jsx)(N(),{href:"/profile/".concat(e.user.username),className:"font-semibold text-sm",children:l}),(0,a.jsx)("p",{className:"text-sm",children:e.description})]}),(0,a.jsx)("div",{className:"flex items-center gap-2 mt-1 text-xs text-muted-foreground",children:(0,a.jsx)("span",{children:e.createdAt.slice(0,10)})})]})]},e.id)}),(0,a.jsxs)("div",{className:"flex items-center gap-2 pt-3",children:[(0,a.jsxs)(n.eu,{className:"h-8 w-8",children:[(0,a.jsx)(n.BK,{src:"https://res.cloudinary.com/".concat(P,"/image/upload/fakeverse/").concat(localStorage.getItem("username"),".png"),alt:"@user"}),(0,a.jsx)(n.q5,{children:"JD"})]}),(0,a.jsxs)("div",{className:"flex-1 flex items-center gap-2",children:[(0,a.jsx)(i.p,{placeholder:"Write a comment...",value:L,onChange:e=>z(e.target.value),className:"flex-1",onKeyDown:e=>{"Enter"===e.key&&W()}}),(0,a.jsxs)(o.$,{size:"icon",variant:"ghost",onClick:W,disabled:!L.trim(),children:[(0,a.jsx)(g.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Send comment"})]})]})]})]})]}),(0,a.jsx)(y,{open:R,onOpenChange:I,title:"Likes",likes:J})]})}},5007:(e,t,s)=>{s.d(t,{BT:()=>i,Wu:()=>d,ZB:()=>c,Zp:()=>n,aR:()=>o,wL:()=>m});var a=s(5155),r=s(2115),l=s(9602);let n=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});n.displayName="Card";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",s),...r})});o.displayName="CardHeader";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});c.displayName="CardTitle";let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",s),...r})});i.displayName="CardDescription";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",s),...r})});d.displayName="CardContent";let m=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",s),...r})});m.displayName="CardFooter"},7837:(e,t,s)=>{s.d(t,{Cf:()=>m,L3:()=>x,c7:()=>u,lG:()=>c});var a=s(5155),r=s(2115),l=s(6217),n=s(767),o=s(9602);let c=l.bL;l.l9;let i=l.ZL;l.bm;let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.hJ,{ref:t,className:(0,o.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r})});d.displayName=l.hJ.displayName;let m=r.forwardRef((e,t)=>{let{className:s,children:r,...c}=e;return(0,a.jsxs)(i,{children:[(0,a.jsx)(d,{}),(0,a.jsxs)(l.UC,{ref:t,className:(0,o.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...c,children:[r,(0,a.jsxs)(l.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(n.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=l.UC.displayName;let u=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,o.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};u.displayName="DialogHeader";let x=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.hE,{ref:t,className:(0,o.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});x.displayName=l.hE.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(l.VY,{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",s),...r})}).displayName=l.VY.displayName}}]);