(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{696:(e,s,a)=>{Promise.resolve().then(a.bind(a,4490))},4490:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>b});var r=a(5155),t=a(2115),n=a(3628),l=a(8173),c=a.n(l),o=a(6507),i=a(1466),d=a(8236),m=a(3898),u=a(5007),h=a(2651);function x(e){let{baseUrl:s}=e,[a,n]=(0,t.useState)(null),[l,x]=(0,t.useState)(0),[p,g]=(0,t.useState)(0),[f,j]=(0,t.useState)(0),[y,b]=(0,t.useState)([]),[N,w]=(0,t.useState)(!0),v="dchytnqhl";return((0,t.useEffect)(()=>{(async()=>{let e=localStorage.getItem("token"),a=localStorage.getItem("username");if(!e||!a){w(!1);return}try{let r=await fetch("".concat(s,"/users/user/").concat(a),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(r.ok){let e=await r.json();n({username:e.username,avatarUrl:e.avatarUrl||""});let t=await h.A.get("".concat(s,"/posts/count/").concat(a));j(t.data.count)}let t=await fetch("".concat(s,"/users/followInfo/").concat(a),{method:"GET",headers:{"Content-Type":"application/json"}});if(t.ok){let e=await t.json();x(Array.isArray(e.followers)?e.followers.length:0),g(Array.isArray(e.following)?e.following.length:0)}let l=await fetch("".concat(s,"/users/recommended"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(l.ok){let e=await l.json();b(e)}}catch(e){console.error("Error fetching sidebar data:",e)}finally{w(!1)}})()},[s]),N)?(0,r.jsx)("div",{className:"space-y-4 sticky top-20",children:(0,r.jsx)("p",{children:"Loading profile..."})}):a?(0,r.jsxs)("div",{className:"space-y-4 sticky top-20",children:[(0,r.jsxs)(u.Zp,{children:[(0,r.jsx)(u.aR,{className:"pb-2",children:(0,r.jsx)(u.ZB,{className:"text-sm font-medium",children:"Profile"})}),(0,r.jsxs)(u.Wu,{className:"grid gap-4",children:[(0,r.jsxs)(c(),{href:"/profile/".concat(a.username),className:"flex items-center gap-4",children:[(0,r.jsxs)(m.eu,{className:"h-12 w-12",children:[(0,r.jsx)(m.BK,{src:"https://res.cloudinary.com/".concat(v,"/image/upload/fakeverse/").concat(a.username,".png"),alt:"@".concat(a.username)}),(0,r.jsx)(m.q5,{children:a.username.charAt(0).toUpperCase()})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium",children:a.username}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["@",a.username]})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-center text-xs",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:f}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Posts"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:l}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Followers"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"font-medium",children:p}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Following"})]})]})]})]}),(0,r.jsxs)(u.Zp,{children:[(0,r.jsx)(u.aR,{className:"pb-2",children:(0,r.jsx)(u.ZB,{className:"text-sm font-medium",children:"Navigation"})}),(0,r.jsx)(u.Wu,{children:(0,r.jsxs)("nav",{className:"grid gap-1",children:[(0,r.jsxs)(c(),{href:"/",className:"flex items-center gap-3 rounded-lg px-3 py-2 text-sm transition-all hover:bg-accent",children:[(0,r.jsx)(o.A,{className:"h-4 w-4"}),"Home"]}),(0,r.jsxs)(c(),{href:"/profile/".concat(a.username),className:"flex items-center gap-3 rounded-lg px-3 py-2 text-sm transition-all hover:bg-accent",children:[(0,r.jsx)(i.A,{className:"h-4 w-4"}),"Profile"]}),(0,r.jsxs)(c(),{href:"/settings",className:"flex items-center gap-3 rounded-lg px-3 py-2 text-sm transition-all hover:bg-accent",children:[(0,r.jsx)(d.A,{className:"h-4 w-4"}),"Settings"]})]})})]}),(0,r.jsxs)(u.Zp,{children:[(0,r.jsx)(u.aR,{className:"pb-2",children:(0,r.jsx)(u.ZB,{className:"text-sm font-medium",children:"Suggested People"})}),(0,r.jsx)(u.Wu,{children:(0,r.jsx)("div",{className:"space-y-3",children:y.length>0?y.map(e=>(0,r.jsx)("div",{className:"flex items-center justify-between",children:(0,r.jsxs)("a",{className:"flex items-center gap-2",href:"/profile/".concat(e.username),children:[(0,r.jsxs)(m.eu,{className:"h-8 w-8",children:[(0,r.jsx)(m.BK,{src:"https://res.cloudinary.com/".concat(v,"/image/upload/fakeverse/").concat(e.username,".png"),alt:e.username}),(0,r.jsx)(m.q5,{children:e.username.charAt(0).toUpperCase()})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-medium",children:e.username}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:["@",e.username]})]})]})},e.id)):(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"No suggestions available"})})})]})]}):(0,r.jsx)("div",{className:"space-y-4 sticky top-20",children:(0,r.jsx)("p",{children:"Error loading user data."})})}var p=a(4085),g=a(371),f=a(8491);function j(e){let{baseUrl:s}=e,[a,n]=(0,t.useState)(""),[l,o]=(0,t.useState)([]),[i,d]=(0,t.useState)("all"),x=localStorage.getItem("username")||"",j="dchytnqhl",y=x&&j?"https://res.cloudinary.com/".concat(j,"/image/upload/fakeverse/").concat(x,".png"):"/placeholder.svg",b=async()=>{let e=localStorage.getItem("token");if(!e)return;let a="all"===i?"".concat(s,"/posts/all"):"".concat(s,"/posts/all/following/").concat(x);try{let s=(await h.A.get(a,{headers:{Authorization:"Bearer ".concat(e)}})).data.map(e=>({...e,user:{...e.user,avatar:j&&e.user.username?"https://res.cloudinary.com/".concat(j,"/image/upload/fakeverse/").concat(e.user.username,".png"):"/placeholder.svg"}}));o(s)}catch(e){console.error("Error fetching posts:",e)}};(0,t.useEffect)(()=>{b()},[s,i]);let N=async()=>{if(!a.trim())return;let e=localStorage.getItem("token");if(e)try{await h.A.post("".concat(s,"/posts/new"),{content:a},{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}),n(""),b()}catch(e){console.error("Error creating post:",e)}},w=e=>{o(s=>s.filter(s=>s.id!==e))};return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(p.$,{variant:"all"===i?"default":"outline",onClick:()=>d("all"),children:"All Posts"}),(0,r.jsx)(p.$,{variant:"following"===i?"default":"outline",onClick:()=>d("following"),children:"Following"})]}),(0,r.jsx)(u.Zp,{children:(0,r.jsx)(u.aR,{className:"pb-3",children:(0,r.jsxs)("div",{className:"flex items-start gap-4",children:[(0,r.jsx)(c(),{href:"/profile/".concat(x),children:(0,r.jsxs)(m.eu,{children:[(0,r.jsx)(m.BK,{src:y,alt:"@".concat(x)}),(0,r.jsx)(m.q5,{children:x.charAt(0).toUpperCase()})]})}),(0,r.jsxs)("div",{className:"grid w-full gap-1.5",children:[(0,r.jsx)(g.T,{placeholder:"What's on your mind?",value:a,onChange:e=>n(e.target.value),className:"min-h-[80px]"}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(p.$,{onClick:N,disabled:!a.trim(),children:"Post"})})]})]})})}),(0,r.jsx)("div",{className:"space-y-4",children:l.map(e=>(0,r.jsx)(f.L,{post:e,baseUrl:s,onDelete:w},e.id))})]})}function y(e){let{baseUrl:s}=e,[a,n]=(0,t.useState)(!0),[l,c]=(0,t.useState)(""),[o,i]=(0,t.useState)("success"),d=e=>{switch(e){case"Username length must be between 3 and 10 characters":return"Username must be between 3 and 10 characters long.";case"Invalid email":return"Please enter a valid email address.";case"Password must be between 5 and 20 characters long":return"Password must be between 5 and 20 characters long.";case"Username has already been taken":return"This username is already in use.";case"Email has already been taken":return"This email address is already in use.";case"Invalid user/password combination":return"The username and password do not match.";default:return e}},m=function(e,s){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];c(e),i(s),setTimeout(()=>{c(""),a&&"success"===s&&(window.location.href="/")},1e3)},u=async e=>{e.preventDefault();let a=new FormData(e.currentTarget),r=a.get("username").toLowerCase(),t=a.get("password");try{let e;let a=await fetch("".concat(s,"/users/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:r,password:t})});try{e=await a.json()}catch(e){console.error("Parsing error:",e),m("Unexpected response from server.","error");return}a.ok?(localStorage.setItem("token",e.token),localStorage.setItem("username",e.username),m("Login successful!","success",!0)):m(d(e||"Login failed"),"error")}catch(e){console.error("Error during login:",e),m("An error occurred during login.","error")}},h=async e=>{e.preventDefault();let a=new FormData(e.currentTarget),r=a.get("username").toLowerCase(),t=a.get("email").toLowerCase(),n=a.get("password");try{let e;let a=await fetch("".concat(s,"/users/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:r,email:t,password:n})});try{e=await a.json()}catch(e){console.error("Parsing error:",e),m("Unexpected response from server.","error");return}a.ok?m("Registration successful!","success",!0):m(d(e||"Registration failed"),"error")}catch(e){console.error("Error during registration:",e),m("An error occurred during registration.","error")}};return(0,r.jsxs)("div",{className:"min-h-screen flex flex-col justify-center items-center bg-gray-50 dark:bg-gray-900 relative",children:[l&&(0,r.jsx)("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 px-4 py-2 text-white rounded shadow-lg z-50 ".concat("error"===o?"bg-red-500":"bg-green-500"),children:l}),(0,r.jsxs)("div",{className:"w-full max-w-md bg-white dark:bg-gray-800 p-6 rounded shadow-md",children:[a?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Login"}),(0,r.jsxs)("form",{onSubmit:u,children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 dark:text-gray-200",children:"Username"}),(0,r.jsx)("input",{type:"text",name:"username",required:!0,className:"w-full px-3 py-2 border rounded",placeholder:"Enter your username"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 dark:text-gray-200",children:"Password"}),(0,r.jsx)("input",{type:"password",name:"password",required:!0,className:"w-full px-3 py-2 border rounded",placeholder:"Enter your password"})]}),(0,r.jsx)("button",{type:"submit",className:"w-full bg-blue-500 text-white px-3 py-2 rounded",children:"Login"})]},"login")]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Register"}),(0,r.jsxs)("form",{onSubmit:h,children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 dark:text-gray-200",children:"Username"}),(0,r.jsx)("input",{type:"text",name:"username",required:!0,className:"w-full px-3 py-2 border rounded",placeholder:"Enter your username"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 dark:text-gray-200",children:"Email"}),(0,r.jsx)("input",{type:"email",name:"email",required:!0,className:"w-full px-3 py-2 border rounded",placeholder:"Enter your email"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700 dark:text-gray-200",children:"Password"}),(0,r.jsx)("input",{type:"password",name:"password",required:!0,className:"w-full px-3 py-2 border rounded",placeholder:"Enter your password"})]}),(0,r.jsx)("button",{type:"submit",className:"w-full bg-green-500 text-white px-3 py-2 rounded",children:"Register"})]},"register")]}),(0,r.jsx)("div",{className:"mt-4 text-center",children:(0,r.jsx)("button",{onClick:()=>{n(!a)},className:"text-blue-500 hover:underline",children:a?"Don't have an account? Register":"Already have an account? Login"})})]})]})}function b(){let[e,s]=(0,t.useState)(null);(0,t.useEffect)(()=>{{let e=localStorage.getItem("token");e?s(e):console.warn("No token found in localStorage. The user might need to log in.")}},[]);let a="https://fakeverse-2.onrender.com";return e?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[(0,r.jsx)(n.Navbar,{}),(0,r.jsxs)("div",{className:"container mx-auto px-4 py-6 grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,r.jsx)("div",{className:"hidden md:block",children:(0,r.jsx)(x,{baseUrl:a})}),(0,r.jsx)("div",{className:"md:col-span-2",children:(0,r.jsx)(j,{baseUrl:a})})]})]}):(0,r.jsx)(y,{baseUrl:a})}},371:(e,s,a)=>{"use strict";a.d(s,{T:()=>l});var r=a(5155),t=a(2115),n=a(9602);let l=t.forwardRef((e,s)=>{let{className:a,...t}=e;return(0,r.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...t})});l.displayName="Textarea"}},e=>{var s=s=>e(e.s=s);e.O(0,[822,721,628,491,441,517,358],()=>s(696)),_N_E=e.O()}]);